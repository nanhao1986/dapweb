package com.ucontrol.dapweb.serviceImp;import com.ucontrol.dapweb.entity.TableModelptDeva;import com.ucontrol.dapweb.entity.appmodels.*;import com.ucontrol.dapweb.service.TableModelDevaService;import com.ucontrol.dapweb.service.TableModelptDevaService;import org.springframework.beans.factory.InitializingBean;import org.springframework.stereotype.Service;import org.springframework.web.context.ServletContextAware;import javax.annotation.Resource;import javax.servlet.ServletContext;import java.lang.reflect.Array;import java.util.ArrayList;/** * 启动Springboot后访问数据库获取内容 * 之后直接访问类获得内容，不再重复访问数据库 */@Servicepublic class AppModels implements InitializingBean, ServletContextAware {    public AppModels() {    }    @Resource    private TableModelDevaService modelDevaService;    @Resource    private TableModelptDevaService modelptDevaService;    public static Model modelDeva;    @Override    public void setServletContext(ServletContext servletContext) {    }    @Override    public void afterPropertiesSet() throws Exception {        modelDeva = modelDevaService.selectAll();        loadptInfo();    }    public void loadptInfo(){        for(Unit unit : modelDeva.getUnitList()){            for(PlantSystem sys : unit.getSystemList()){                int sys_level = 2;                int sys_index = sys.getIndex();                ArrayList<TableModelptDeva> sys_record = modelptDevaService.selectByLevelAndIndex(sys_level, sys_index);                ArrayList<Item> sysItems = new ArrayList<>();                for(TableModelptDeva sys_rcd : sys_record){                    int sys_pt_id = sys_rcd.getPtId();                    Item sysItem = new Item(sys_pt_id);                    sysItems.add(sysItem);                }                sys.setItemList(sysItems);                for(Device dev : sys.getDeviceList()){                    int dev_level = 3;                    int dev_index = dev.getIndex();                    ArrayList<TableModelptDeva> dev_record = modelptDevaService.selectByLevelAndIndex(dev_level, dev_index);                    ArrayList<Item> devItems = new ArrayList<>();                    for(TableModelptDeva dev_rcd : dev_record){                        int dev_pt_id = dev_rcd.getPtId();                        Item devItem = new Item(dev_pt_id);                        devItems.add(devItem);                    }                    dev.setItemList(devItems);                }            }        }    }}