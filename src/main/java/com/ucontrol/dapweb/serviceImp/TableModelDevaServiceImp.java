package com.ucontrol.dapweb.serviceImp;import com.ucontrol.dapweb.dao.TableModelDevaMapper;import com.ucontrol.dapweb.entity.TableModelDeva;import com.ucontrol.dapweb.entity.appmodels.*;import com.ucontrol.dapweb.service.TableModelDevaService;import com.ucontrol.dapweb.service.TableModelptDevaService;import org.springframework.stereotype.Service;import javax.annotation.Resource;import java.util.ArrayList;@Service("TableModelDevaService")public class TableModelDevaServiceImp implements TableModelDevaService {    @Resource    private TableModelDevaMapper tableModelDevaDao;    @Override    public int importModel(Model model) {        int res = 0;        for(Unit unit : model.getUnitList()){            int unit_index = unit.getIndex();            String unit_name = unit.getName();            int unit_level = 1;            int unit_parent_index = 0;            TableModelDeva unit_record = new TableModelDeva();            setRecord(unit_index, unit_name, unit_level, unit_parent_index, unit_record);            res = tableModelDevaDao.insert(unit_record);            for(PlantSystem sys : unit.getSystemList()){                int sys_index = sys.getIndex();                String sys_name = sys.getName();                int sys_level = 2;                int sys_parent_index = unit_index;                TableModelDeva sys_record = new TableModelDeva();                setRecord(sys_index, sys_name, sys_level, sys_parent_index, sys_record);                res = tableModelDevaDao.insert(sys_record);                for(Device dev : sys.getDeviceList()){                    int dev_index = dev.getIndex();                    String dev_name = dev.getName();                    int dev_level = 3;                    int dev_parent_index = sys_index;                    TableModelDeva dev_record = new TableModelDeva();                    setRecord(dev_index, dev_name, dev_level, dev_parent_index, dev_record);                    res = tableModelDevaDao.insert(dev_record);                }            }        }        return res;    }    @Override    public Model selectAll() {        ArrayList<Unit> units = new ArrayList<>();        ArrayList<TableModelDeva> units_table = tableModelDevaDao.selectByLevel(1);        for(TableModelDeva unit_table : units_table){            int unit_id = unit_table.getId();            int unit_index = unit_table.getIndex();            String unit_name = unit_table.getName();            Unit unit = new Unit(unit_index,unit_name);            unit.setId(unit_id);            ArrayList<PlantSystem> systems = new ArrayList<>();            ArrayList<TableModelDeva> syss_table = tableModelDevaDao.selectByParent(2,unit_index);            for(TableModelDeva sys_table : syss_table){                int sys_id = sys_table.getId();                int sys_index = sys_table.getIndex();                String sys_name = sys_table.getName();                PlantSystem system = new PlantSystem(sys_index, sys_name);                system.setId(sys_id);                ArrayList<Device> devices = new ArrayList<>();                ArrayList<TableModelDeva> devs_table = tableModelDevaDao.selectByParent(3,sys_index);                for(TableModelDeva dev_table : devs_table){                    int dev_id = dev_table.getId();                    int dev_index = dev_table.getIndex();                    String dev_name = dev_table.getName();                    Device device = new Device(dev_index, dev_name);                    device.setId(dev_id);                    devices.add(device);                }                system.setDeviceList(devices);                systems.add(system);            }            unit.setSystemList(systems);            units.add(unit);        }        Model model = new Model("deva");        model.setUnitList(units);        return model;    }    public void setRecord(int index, String name, int level, int parentIndex, TableModelDeva modelDeva){        modelDeva.setIndex(index);        modelDeva.setName(name);        modelDeva.setLevel(level);        modelDeva.setParentIndex(parentIndex);    }}